specVersion: 1.0.0
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum
    name: ZapContract
    network: optimism
    source:
      address: "0x1234567890123456789012345678901234567890" # Replace with actual ZapContract address
      abi: ZapContract
      startBlock: 110000000 
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - ZapInteraction
      abis:
        - name: ZapContract
          file: ../artifacts/contracts/ZapContract.sol/ZapContract.json
      eventHandlers:
        - event: ZapExecuted(indexed address,uint256,uint256,indexed bytes32,uint256,uint256,uint256)
          handler: handleZapExecuted

  - kind: ethereum
    name: MarketGovernance
    network: optimism
    source:
      address: "0x0987654321098765432109876543210987654321" # Replace with actual MarketGovernance address
      abi: MarketGovernance
      startBlock: 110000000
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - MarketProposal
        - Vote
        - RoyaltyClaim
        - MerkleDistribution
      abis:
        - name: MarketGovernance
          file: ../artifacts/contracts/MarketGovernance.sol/MarketGovernance.json
      eventHandlers:
        - event: MerkleRootPublished(indexed uint256,indexed bytes32,uint256,uint256)
          handler: handleMerkleRootPublished
        - event: RoyaltiesClaimed(indexed uint256,indexed address,uint256)
          handler: handleRoyaltiesClaimed
        - event: RoyaltiesBatchClaimed(indexed address,uint256,uint256)
          handler: handleRoyaltiesBatchClaimed
        # Note: Proposal creation and voting happen off-chain primarily in this architecture (Supabase + World ID),
        # but if we emit on-chain events for settlement, we would index them here.
        # Assuming for this subgraph we only index the *on-chain settlement* part or if we upgraded governance to emit events.
        # Given the prompt asks to index Zap and Governance, and Governance contract mainly handles Royalties, we focus on that.
